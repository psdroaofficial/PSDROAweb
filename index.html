<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PSDROA – Peoples Socialist Democratic Republic of Amityans</title>
  <link rel="icon" href="IMG_0508.jpeg" />
  <style>
    body {
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, sans-serif;
      margin: 0;
      padding: 0;
      background: #111;
      color: #eee;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    header {
      text-align: center;
      padding: 60px 20px 40px;
      border-bottom: 1px solid #222;
    }

    header img {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      margin-bottom: 15px;
    }

    header h1 {
      font-size: 1.8rem;
      margin: 10px 0 5px;
      font-weight: 500;
    }

    header p {
      font-style: italic;
      color: #aaa;
      margin: 0;
    }

    main {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 20px;
    }

    a.join-btn {
      background: #0a8f6a;
      color: #fff;
      text-decoration: none;
      padding: 14px 36px;
      border-radius: 6px;
      font-size: 1rem;
      transition: background 0.3s ease;
    }

    a.join-btn:hover {
      background: #087a59;
    }

    button.secret-btn, button#save-btn {
      background: transparent;
      color: #888;
      border: 1px solid #333;
      padding: 10px 25px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 0.9rem;
      transition: all 0.3s;
    }

    button.secret-btn:hover, button#save-btn:hover {
      color: #fff;
      border-color: #0a8f6a;
    }

    #special-section {
      display: none;
      flex-direction: column;
      align-items: center;
      padding: 20px;
      width: 90%;
      max-width: 800px;
      margin: 30px auto;
      border-top: 1px solid #222;
      gap: 10px;
    }

    #special-section textarea {
      width: 100%;
      height: 500px;
      background: #1b1b1b;
      color: #ddd;
      border: 1px solid #333;
      border-radius: 6px;
      padding: 10px;
      resize: vertical;
      font-family: monospace;
      overflow: auto;
    }

    footer {
      text-align: center;
      padding: 15px;
      font-size: 0.9rem;
      color: #777;
      border-top: 1px solid #222;
    }

    footer span {
      color: #0a8f6a;
      font-weight: 600;
    }
  </style>
</head>
<body>
  <header>
    <img src="IMG_0508.jpeg" alt="PSDROA Logo" />
    <h1>Peoples Socialist Democratic Republic of Amityans</h1>
    <p>“Be Free Forever.”</p>
  </header>

  <main>
    <a href="https://psdroaregister.netlify.app/" class="join-btn" target="_blank">
      Join PSDROA
    </a>

    <button class="secret-btn" onclick="accessSecret()">Special Purposes</button>

    <div id="special-section">
      <h3>Special Purposes Access</h3>
      <textarea id="special-text"></textarea>
      <button id="save-btn" onclick="saveText()">Save</button>
    </div>
  </main>

  <footer>
    © 2025 <span>PSDROA</span>. All rights reserved. | Made by the Republic.
  </footer>

  <script>
    const USERNAME = "psdadmin";
    const PASSWORD = "A9x7qR!3";

    // JSONBin credentials
    const BIN_ID = "690377df43b1c97be98c57f7";
    const MASTER_KEY = "$2a$10$N7Wza0NGDUCgaPy3HFSYzOeK4WS5PUMeTrtLSPC9GzUmK.gf3Z/TS";
    const ACCESS_KEY = "$2a$10$wpzRqDW3wUNmYfvbnQnbw.wSicD9GaqJa86I3Jwr5QZbIC2mPuspi";

    async function loadText() {
      try {
        const res = await fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}/latest`, {
          headers: {
            "X-Master-Key": MASTER_KEY,
            "X-Access-Key": ACCESS_KEY
          }
        });
        const data = await res.json();
        document.getElementById("special-text").value = data.record.specialText || "";
      } catch (err) {
        console.error("Error loading text:", err);
      }
    }

    async function saveText() {
      const text = document.getElementById("special-text").value;
      try {
        await fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}`, {
          method: "PUT",
          headers: {
            "Content-Type": "application/json",
            "X-Master-Key": MASTER_KEY,
            "X-Access-Key": ACCESS_KEY
          },
          body: JSON.stringify({ specialText: text })
        });
        alert("Text saved!");
      } catch (err) {
        console.error("Error saving text:", err);
        alert("Failed to save text.");
      }
    }

    function accessSecret() {
      // Check if already logged in on this device
      if (localStorage.getItem("psdLoggedIn") === "true") {
        document.getElementById("special-section").style.display = "flex";
        loadText();
        return;
      }

      const user = prompt("Enter username:");
      const pass = prompt("Enter password:");
      if (user === USERNAME && pass === PASSWORD) {
        localStorage.setItem("psdLoggedIn", "true"); // remember login for this device
        document.getElementById("special-section").style.display = "flex";
        alert("Access granted.");
        loadText();
      } else {
        alert("Access denied.");
      }
    }

    // Optional: logout button functionality
    function logout() {
      localStorage.removeItem("psdLoggedIn");
      document.getElementById("special-section").style.display = "none";
    }
  </script>
</body>
</html>
