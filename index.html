<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PSDROA – Peoples Socialist Democratic Republic of Amityans</title>
<link rel="icon" href="IMG_0508.jpeg">
<style>
body { font-family: system-ui, -apple-system, "Segoe UI", Roboto, sans-serif; margin:0; padding:0; background:#111; color:#eee; display:flex; flex-direction:column; min-height:100vh; }
header { text-align:center; padding:60px 20px 40px; border-bottom:1px solid #222; position:relative; }
header img { width:100px; height:100px; border-radius:50%; margin-bottom:15px; }
header h1 { font-size:1.8rem; margin:10px 0 5px; font-weight:500; }
header p { font-style:italic; color:#aaa; margin:0; }
.top-right-btn { position:absolute; top:20px; right:20px; background:#0a8f6a; color:#fff; border:none; padding:10px 18px; border-radius:6px; cursor:pointer; transition:0.3s; }
.top-right-btn:hover { background:#087a59; }
main { flex:1; display:flex; flex-direction:column; align-items:center; gap:30px; padding:20px; width:100%; max-width:900px; margin:0 auto; }
a.join-btn { background:#0a8f6a; color:#fff; text-decoration:none; padding:14px 36px; border-radius:6px; font-size:1rem; transition:0.3s; }
a.join-btn:hover { background:#087a59; }
button, .secret-btn { background:transparent; color:#888; border:1px solid #333; padding:10px 25px; border-radius:5px; cursor:pointer; font-size:0.9rem; transition:all 0.3s; }
button:hover, .secret-btn:hover { color:#fff; border-color:#0a8f6a; }
textarea { width:100%; background:#1b1b1b; color:#ddd; border:1px solid #333; border-radius:6px; padding:10px; resize:none; font-family: monospace; }
footer { text-align:center; padding:15px; font-size:0.9rem; color:#777; border-top:1px solid #222; }
footer span { color:#0a8f6a; font-weight:600; }
.public-view, .editor-only, #doc-editor, #special-section { width:100%; max-width:700px; margin-top:15px; }
.editor-only { display:none; flex-direction:column; gap:10px; }
#doc-text { height:600px; }
.button-group { display:flex; gap:10px; flex-wrap:wrap; margin-top:10px; }
</style>
</head>
<body>

<header>
<img src="IMG_0508.jpeg" alt="PSDROA Logo">
<h1>Peoples Socialist Democratic Republic of Amityans</h1>
<p>“Be Free Forever.”</p>
<button id="editor-login-btn" class="top-right-btn">Editor Login</button>
</header>

<main>
<a href="https://psdroaregister.netlify.app/" class="join-btn" target="_blank">Join PSDROA</a>

<!-- Special Purposes -->
<button class="secret-btn" onclick="accessSpecial()">Special Purposes</button>
<div id="special-section" style="display:none;">
<h3>Special Purposes Access</h3>
<textarea></textarea>
</div>

<!-- Announcement Section -->
<div id="announcement-section">
<h3>Announcements</h3>
<div id="announcement-view" class="public-view">Loading announcement...</div>
<div class="editor-only">
<textarea id="announcement-text"></textarea>
<button id="save-ann-btn">Save Announcement</button>
</div>
</div>

<!-- Docs Section -->
<div id="docs-section">
<h3>Docs</h3>
<p>This is PSDROA's alternative to Notepad — for general purposes and code editing.</p>
<div class="button-group">
<button id="create-doc-btn">Create New Doc</button>
<button id="load-doc-btn">Load Doc</button>
</div>

<div id="doc-editor" style="display:none;">
<input type="text" id="current-doc-id" readonly placeholder="Bin ID will appear here">
<textarea id="doc-text"></textarea>
<div class="button-group">
<button id="save-doc-btn">Save Doc</button>
<button id="delete-doc-btn">Delete Doc (Editors Only)</button>
<button id="export-doc-btn">Export as .txt</button>
</div>
</div>
</div>

<!-- Ads Section -->
<div id="ads-section">
<h3>Advertisements</h3>
<div id="ads-view">No ads yet.</div>
<div class="editor-only">
<textarea id="ad-text" placeholder="Ad text"></textarea>
<input type="text" id="ad-link" placeholder="Ad link (optional)">
<button id="create-ad-btn">Create Ad</button>
</div>
<p style="color:#aaa; font-size:0.9rem;">For inquiries, mail <strong>psdroa.official@gmail.com</strong></p>
</div>

</main>

<footer>
© 2025 <span>PSDROA</span>. All rights reserved. | Made by the Republic.
</footer>

<script>
<script>
// ==== Special Purposes Login & Data Retrieval ====

const SPECIAL_USER = "psdadmin";
const SPECIAL_PASS = "A9x7qR!3";

// Your JSON Bin details
const SPECIAL_BIN_ID = "690377df43b1c97be98c57f7";
const MASTER_KEY = "$2a$10$N7Wza0NGDUCgaPy3HFSYzOeK4WS5PUMeTrtLSPC9GzUmK.gf3Z/TS"; 
const ACCESS_KEY = "$2a$10$wpzRqDW3wUNmYfvbnQnbw.wSicD9GaqJa86I3Jwr5QZbIC2mPuspi";

const specialSection = document.getElementById("special-section");
const specialText = document.getElementById("special-text");
const saveSpecialBtn = document.getElementById("save-special-btn");

// --- Login Function ---
async function accessSpecial(){
  const user = prompt("Enter username:");
  const pass = prompt("Enter password:");

  if(user === SPECIAL_USER && pass === SPECIAL_PASS){
    alert("Access granted.");
    specialSection.style.display = "flex";
    await loadSpecial(); // load from bin after successful login
  } else {
    alert("Access denied.");
  }
}

// --- Load Data from JSON Bin ---
async function loadSpecial(){
  try {
    const res = await fetch(`https://api.jsonbin.io/v3/b/${SPECIAL_BIN_ID}/latest`, {
      headers: {
        "X-Master-Key": MASTER_KEY,
        "X-Access-Key": ACCESS_KEY
      }
    });
    if (!res.ok) throw new Error("Failed to fetch data");
    const data = await res.json();
    specialText.value = data.record.content || "No data available.";
  } catch (err) {
    console.error(err);
    alert("⚠️ Failed to load special data.");
  }
}

// --- Save Data to JSON Bin ---
async function saveSpecial(){
  try {
    await fetch(`https://api.jsonbin.io/v3/b/${SPECIAL_BIN_ID}`, {
      method: "PUT",
      headers: {
        "Content-Type": "application/json",
        "X-Master-Key": MASTER_KEY,
        "X-Access-Key": ACCESS_KEY
      },
      body: JSON.stringify({ content: specialText.value })
    });
    alert("✅ Special data saved successfully!");
  } catch (err) {
    console.error(err);
    alert("❌ Failed to save data.");
  }
}

// Attach event to save button
if(saveSpecialBtn) saveSpecialBtn.addEventListener("click", saveSpecial);
</script>

// ==== Global Editors Login ====
const GLOBAL_EDITORS = {
  "Bryan":"Bry@2025!",
  "Jensen":"J3ns3n#Save",
  "Ahmad":"Ahm4d$Edit"
};
const editorLoginBtn = document.getElementById("editor-login-btn");
editorLoginBtn.addEventListener("click", ()=>{
  if(localStorage.getItem("editorLoggedIn")==="true"){
    showEditorTools();
    return;
  }
  const user = prompt("Editor Username:");
  const pass = prompt("Password:");
  if(GLOBAL_EDITORS[user] && GLOBAL_EDITORS[user]===pass){
    localStorage.setItem("editorLoggedIn","true");
    showEditorTools();
  } else alert("Access denied.");
});

function showEditorTools(){
  document.querySelectorAll(".editor-only").forEach(el=>el.style.display="flex");
  alert("Editor tools enabled for this device.");
}

// ==== Announcements ====
const ANN_BIN_ID = "6903802ed0ea881f40c76129";
const MASTER_KEY = "$2a$10$N7Wza0NGDUCgaPy3HFSYzOeK4WS5PUMeTrtLSPC9GzUmK.gf3Z/TS";
const ACCESS_KEY = "$2a$10$wpzRqDW3wUNmYfvbnQnbw.wSicD9GaqJa86I3Jwr5QZbIC2mPuspi";

const annTextarea = document.getElementById("announcement-text");
const annView = document.getElementById("announcement-view");
const saveAnnBtn = document.getElementById("save-ann-btn");

async function loadAnn(){
  try{
    const res = await fetch(`https://api.jsonbin.io/v3/b/${ANN_BIN_ID}/latest`,{
      headers:{ "X-Master-Key": MASTER_KEY,"X-Access-Key":ACCESS_KEY }
    });
    const data = await res.json();
    const content = data.record?.content || "";
    annTextarea.value = content;
    annView.textContent = content;
  } catch(err){ console.error(err); annView.textContent = "Failed to load announcement."; }
}
loadAnn();

saveAnnBtn.addEventListener("click", async ()=>{
  try{
    await fetch(`https://api.jsonbin.io/v3/b/${ANN_BIN_ID}`,{
      method:"PUT",
      headers:{ "Content-Type":"application/json","X-Master-Key":MASTER_KEY,"X-Access-Key":ACCESS_KEY },
      body: JSON.stringify({ content: annTextarea.value })
    });
    annView.textContent = annTextarea.value;
    alert("Announcement saved!");
  } catch(err){ console.error(err); alert("Failed to save."); }
});

// ==== Docs ====
let currentDocId = null;
const docEditor = document.getElementById("doc-editor");
const docTextarea = document.getElementById("doc-text");
const currentDocInput = document.getElementById("current-doc-id");
const createDocBtn = document.getElementById("create-doc-btn");
const loadDocBtn = document.getElementById("load-doc-btn");
const saveDocBtn = document.getElementById("save-doc-btn");
const deleteDocBtn = document.getElementById("delete-doc-btn");
const exportDocBtn = document.getElementById("export-doc-btn");

createDocBtn.addEventListener("click", async ()=>{
  const title = prompt("Enter doc title/ID:");
  if(!title) return;
  try{
    const res = await fetch("https://api.jsonbin.io/v3/b",{
      method:"POST",
      headers:{ "Content-Type":"application/json","X-Master-Key":MASTER_KEY,"X-Access-Key":ACCESS_KEY },
      body: JSON.stringify({ title, content:"" })
    });
    const data = await res.json();
    currentDocId = data.metadata.id;
    currentDocInput.value = currentDocId;
    docTextarea.value="";
    docEditor.style.display="block";
    alert("New doc created! Bin ID: "+currentDocId);
  } catch(err){ console.error(err); alert("Failed to create doc."); }
});

loadDocBtn.addEventListener("click", async ()=>{
  const binId = prompt("Enter Bin ID to load:");
  if(!binId) return;
  try{
    const res = await fetch(`https://api.jsonbin.io/v3/b/${binId}/latest`,{
      headers:{ "X-Master-Key":MASTER_KEY,"X-Access-Key":ACCESS_KEY }
    });
    const data = await res.json();
    currentDocId = binId;
    currentDocInput.value = currentDocId;
    docTextarea.value = data.record.content || "";
    docEditor.style.display="block";
    alert("Doc loaded.");
  } catch(err){ console.error(err); alert("Failed to load doc."); }
});

saveDocBtn.addEventListener("click", async ()=>{
  if(!currentDocId){ alert("No doc loaded."); return; }
  try{
    await fetch(`https://api.jsonbin.io/v3/b/${currentDocId}`,{
      method:"PUT",
      headers:{ "Content-Type":"application/json","X-Master-Key":MASTER_KEY,"X-Access-Key":ACCESS_KEY },
      body: JSON.stringify({ content: docTextarea.value })
    });
    alert("Doc saved!");
  } catch(err){ console.error(err); alert("Failed to save."); }
});

deleteDocBtn.addEventListener("click", async ()=>{
  if(!currentDocId){ alert("No doc loaded."); return; }
  if(!confirm("Are you sure you want to delete this doc?")) return;
  try{
    await fetch(`https://api.jsonbin.io/v3/b/${currentDocId}`,{
      method:"DELETE",
      headers:{ "X-Master-Key":MASTER_KEY,"X-Access-Key":ACCESS_KEY }
    });
    currentDocId=null;
    docTextarea.value="";
    currentDocInput.value="";
    docEditor.style.display="none";
    alert("Doc deleted!");
  } catch(err){ console.error(err); alert("Failed to delete."); }
});

exportDocBtn.addEventListener("click", ()=>{
  const text = docTextarea.value;
  if(!text){ alert("Nothing to export!"); return; }
  const blob = new Blob([text], { type:"text/plain" });
  const url = URL.createObjectURL(blob);
  const link = document.createElement("a");
  link.href = url;
  link.download = "PSDROA_doc.txt";
  document.body.appendChild(link);
  link.click();
  document.body.removeChild(link);
  URL.revokeObjectURL(url);
});

// ==== Ads ====
const adsView = document.getElementById("ads-view");
const adText = document.getElementById("ad-text");
const adLink = document.getElementById("ad-link");
const createAdBtn = document.getElementById("create-ad-btn");

createAdBtn.addEventListener("click", ()=>{
  if(!adText.value){ alert("Ad text required."); return; }
  const adEl = document.createElement("div");
  adEl.style.border="1px solid #333"; adEl.style.padding="8px"; adEl.style.margin="5px 0"; adEl.style.borderRadius="5px";
  const linkHTML = adLink.value ? `<a href="${adLink.value}" target="_blank" style="color:#0a8f6a;">Link</a>` : "";
  adEl.innerHTML = `<p>${adText.value}</p>${linkHTML}`;
  adsView.appendChild(adEl);
  adText.value=""; adLink.value="";
});
</script>

</body>
</html>
